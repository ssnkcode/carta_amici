function generateExtrasHTML(e){let a="";const n=["hamburguesa","sandwich","papas"].includes(e.category),t="pizza"===e.category,s="empanadas"===e.category,c=s&&e.name.toLowerCase().includes("unidad"),l=s&&e.name.toLowerCase().includes("1/2");let i="",o="";c||l?(i="Elegir Gustos (Obligatorio)",o="fa-utensils"):n&&t?(i="Agregar Adicionales",o="fa-plus-circle"):n?(i="Agregar Salsas",o="fa-wine-bottle"):(i="Agregar Notas",o="fa-sticky-note");a+=`\n            <button type="button" class="extras-toggle-btn ${c||l?"required-section":""}" data-product-id="${e.id}">\n                <span>\n                    <i class="fas ${o}"></i>\n                    ${i}\n                </span>\n                <i class="fas fa-chevron-down"></i>\n            </button>\n            <div class="extras-container" id="extras-container-${e.id}">\n        `,c&&e.flavors&&e.flavors.length>0&&(a+=`\n                <div class="flavors-section">\n                    <h4 class="flavors-title">Seleccioná el gusto (1):</h4>\n                    <div class="flavors-grid-radio">\n                        ${e.flavors.map(((a,n)=>`\n                            <label class="flavor-radio-option">\n                                <input type="radio" name="flavor-unit-${e.id}" value="${a}" class="flavor-unit-radio">\n                                <span class="flavor-name">${a}</span>\n                            </label>\n                        `)).join("")}\n                    </div>\n                </div>\n            `),l&&e.flavors&&e.flavors.length>0&&(a+=`\n                <div class="flavors-section">\n                    <h4 class="flavors-title">Seleccioná los 6 gustos:</h4>\n                    <div class="flavors-counter-info">Llevas seleccionadas: <span id="counter-total-${e.id}">0</span>/6</div>\n                    <div class="general-extras-grid">\n                        ${e.flavors.map(((a,n)=>`\n                            <div class="general-extra-option flavor-counter-row">\n                                <span class="flavor-name-counter">${a}</span>\n                                <div class="extra-quantity-selector">\n                                    <button type="button" class="extra-qty-btn minus" onclick="updateFlavorQty('${e.id}', '${n}', -1)">-</button>\n                                    <input type="number" id="flavor-qty-${e.id}-${n}" \n                                           class="extra-qty-input flavor-qty-input-${e.id}" \n                                           data-name="${a}"\n                                           value="0" min="0" max="6" readonly>\n                                    <button type="button" class="extra-qty-btn plus" onclick="updateFlavorQty('${e.id}', '${n}', 1)">+</button>\n                                </div>\n                            </div>\n                        `)).join("")}\n                    </div>\n                </div>\n            `),n&&(a+=`\n                <div class="sauces-section">\n                    <h4 class="sauces-title"><i class="fas fa-wine-bottle"></i> Salsas adicionales:</h4>\n                    <div class="sauce-options">\n                        ${["Mayonesa","Ketchup","Mostaza"].map((a=>`\n                            <label class="sauce-option">\n                                <input type="checkbox" class="sauce-checkbox" data-product-id="${e.id}" data-name="${a}" data-price="50">\n                                <span class="sauce-name">${a}</span>\n                                <span class="sauce-price">+$50</span>\n                            </label>\n                        `)).join("")}\n                        <label class="sauce-option">\n                            <input type="checkbox" class="sauce-checkbox" data-product-id="${e.id}" data-name="Salsa BBQ" data-price="80">\n                            <span class="sauce-name">Salsa BBQ</span>\n                            <span class="sauce-price">+$80</span>\n                        </label>\n                    </div>\n                </div>\n            `),t&&(a+=`\n                <div class="general-extras-section">\n                    <h4 class="general-extras-title"><i class="fas fa-plus-circle"></i> Adicionales:</h4>\n                    <div class="general-extras-grid">\n                        ${[{id:"doble-mozzarella",name:"Doble Mozzarella",price:100,desc:"Extra de queso"},{id:"jamon-extra",name:"Jamón extra",price:120,desc:"Doble porción"},{id:"tomate-extra",name:"Tomate extra",price:60,desc:"Rodajas adicionales"},{id:"morron",name:"Morrón",price:80,desc:"Tiras de pimiento"},{id:"aceitunas",name:"Aceitunas",price:70,desc:"Verdes o negras"},{id:"anchoas",name:"Anchoas",price:150,desc:"Filetes de anchoa"}].map((a=>`\n                            <label class="general-extra-option">\n                                <div class="general-extra-info">\n                                    <div class="general-extra-label">\n                                        <span class="general-extra-name">${a.name}</span>\n                                        <span class="general-extra-description">${a.desc}</span>\n                                    </div>\n                                    <span class="general-extra-price">+$${a.price}</span>\n                                </div>\n                                <input type="checkbox" class="general-extra-checkbox" \n                                       data-product-id="${e.id}" \n                                       data-extra-id="${a.id}-${e.id}"\n                                       data-name="${a.name}" \n                                       data-price="${a.price}">\n                                <div class="extra-quantity-selector">\n                                    <button type="button" class="extra-qty-btn minus" onclick="updateExtraQty('${a.id}-${e.id}', -1)">-</button>\n                                    <input type="number" id="extra-qty-${a.id}-${e.id}" class="extra-qty-input" value="1" min="1" max="10" readonly>\n                                    <button type="button" class="extra-qty-btn plus" onclick="updateExtraQty('${a.id}-${e.id}', 1)">+</button>\n                                </div>\n                            </label>\n                        `)).join("")}\n                    </div>\n                </div>\n            `),a+=`\n                <div class="product-notes-container">\n                    <label class="product-notes-label">\n                        <i class="fas fa-sticky-note"></i>\n                        Notas adicionales:\n                    </label>\n                    <textarea id="product-notes-${e.id}" class="product-notes-input" \n                              placeholder="Ej: Sin sal, bien cocida..." \n                              rows="2"></textarea>\n                </div>\n            `,a+="</div>";return a}function setupExtrasEventListeners(e){const a=document.querySelector(`.extras-toggle-btn[data-product-id="${e}"]`),n=document.getElementById(`extras-container-${e}`);a&&n&&a.addEventListener("click",(function(e){e.stopPropagation();this.classList.contains("expanded")?(this.classList.remove("expanded"),n.classList.remove("expanded")):(this.classList.add("expanded"),n.classList.add("expanded"))})),document.querySelectorAll(`.sauce-checkbox[data-product-id="${e}"]`).forEach((e=>{e.addEventListener("change",(function(){const e=this.parentElement;this.checked?e.classList.add("selected"):e.classList.remove("selected")}))})),document.querySelectorAll(`.general-extra-checkbox[data-product-id="${e}"]`).forEach((e=>{e.addEventListener("change",(function(){const e=this.parentElement;this.checked?e.classList.add("selected"):e.classList.remove("selected")}))})),document.querySelectorAll(`input[name="flavor-unit-${e}"]`).forEach((a=>{a.addEventListener("change",(function(){document.querySelectorAll(`input[name="flavor-unit-${e}"]`).forEach((e=>{e.parentElement.classList.remove("selected")})),this.checked&&this.parentElement.classList.add("selected")}))}))}function updateFlavorQty(e,a,n){const t=document.getElementById(`flavor-qty-${e}-${a}`),s=document.getElementById(`counter-total-${e}`);if(!t||!s)return;let c=0;const l=document.querySelectorAll(`.flavor-qty-input-${e}`);l.forEach((e=>c+=parseInt(e.value||0)));let i=(parseInt(t.value)||0)+n;i<0||(n>0&&c>=6?showNotification("¡Ya seleccionaste las 6 empanadas!","warning"):(t.value=i,c=0,l.forEach((e=>c+=parseInt(e.value||0))),s.textContent=c,i>0?t.parentElement.parentElement.classList.add("selected"):t.parentElement.parentElement.classList.remove("selected")))}function updateExtraQty(e,a){const n=document.getElementById(`extra-qty-${e}`);if(!n)return;let t=(parseInt(n.value)||1)+a;t<1&&(t=1),t>10&&(t=10),n.value=t}window.getEmpanadaSelection=function(e,a,n){if(a){const a=document.querySelector(`input[name="flavor-unit-${e}"]:checked`);return a?[a.value]:[]}if(n){const a=[],n=document.querySelectorAll(`.flavor-qty-input-${e}`);n.forEach((e=>{const n=parseInt(e.value||0),t=e.dataset.name;n>0&&a.push(`${n}x ${t}`)}));let t=0;return n.forEach((e=>t+=parseInt(e.value||0))),{flavorsList:a,totalCount:t}}return null},window.resetEmpanadaSelection=function(e){document.querySelectorAll(`input[name="flavor-unit-${e}"]`).forEach((e=>{e.checked=!1,e.parentElement.classList.remove("selected")})),document.querySelectorAll(`.flavor-qty-input-${e}`).forEach((e=>{e.value=0,e.parentElement.parentElement.classList.remove("selected")}));const a=document.getElementById(`counter-total-${e}`);a&&(a.textContent="0")};